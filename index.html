<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vodič kroz tranziciju sportista</title>
    <!-- Tailwind CSS CDN for JIT mode -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Supabase JavaScript library -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
        /* Custom styles if needed, or to override Tailwind */
        body {
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
        }
    </style>
</head>
<body class="relative min-h-screen bg-cover bg-center text-white" style="background-image: url('public/images/backgroung-theme.jpeg');">
    <!-- Overlay for better text readability -->
    <div class="absolute inset-0 bg-black opacity-60 z-0"></div>

    <div class="relative z-10">
        <!-- Header -->
        <header class="sticky top-0 z-20 w-full py-4 px-6 flex justify-between items-center bg-gray-900 bg-opacity-70 shadow-md">
            <div class="flex items-center space-x-4">
                <h1 class="text-2xl font-bold text-primary-foreground">Vodič kroz tranziciju sportista</h1>
            </div>
            <div class="flex flex-col space-y-2 md:flex-row md:space-x-6 md:space-y-0 text-sm">
                <a href="https://www.instagram.com/drmpaunovic?igsh=dWNyd3d2OGxhcXoy" class="flex items-center gap-2 hover:underline">
                    <!-- Instagram SVG icon -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 md:h-4 md:w-4"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" y1="6.5" x2="17.5" y2="6.5"/></svg>
                </a>
                <a href="mailto:drmisko@gmail.com" class="flex items-center gap-2 hover:underline">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 md:h-4 md:w-4"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
                    <span>drmisko@gmail.com</span>
                </a>

                <button id="newsletter-btn" class="flex items-center gap-2 hover:underline text-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 md:h-4 md:w-4"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                    <span>Newsletter</span>
                </button>
                <button id="contact-btn" class="flex items-center gap-2 hover:underline text-sm cursor-pointer">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 md:h-4 md:w-4"><path d="M22 2H2v16h20l-4 4z"/><path d="m22 2-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 2"/></svg>
                    <span>Contact me</span>
                </button>

            </div>
        </header>

        <!-- Main Content -->
        <div class="max-w-xl mx-auto text-center">
            <h1 class="text-4xl md:text-6xl font-extrabold mb-6 leading-tight drop-shadow-lg">
                dr. Milorad Paunović
            </h1>
            <img
                src="./public/images/misko.jpg"
                width="600"
                height="400"
                alt="Athlete in action"
                class="w-full rounded-lg shadow-xl mb-8 max-w-full h-auto object-cover"
            />
            <div class="max-w-3xl text-lg md:text-xl leading-relaxed mb-10 drop-shadow-md mx-auto">
                <h1 class="text-2xl font-bold mt-6 mb-2">Hej! Ako si ovde, verovatno osećaš da te zove nešto više.</h1> <br>
                <p>Ja sam dr Milorad, sportista, doktor medicine, specijalizant psihijatrije, i stručnjak za mentalne tehnike koje vrhunski sportisti koriste da ostanu nepobedivi. Razumem duboku psihološku dinamiku sporta jer sam godinama analizirao kako se najveći šampioni nosе sa izazovima.</p> <br>
                <p>Ovaj sajt nije o meni. Ovaj sajt je o tebi — o onom delu tebe koji zna da može više. Ne više napora, nego više smisla.</p> <br>
                <h2 class="text-2xl font-bold mt-6 mb-2">Ovo mesto je za tebe ako:</h2><br>
                <p>🎯 Imaš osećaj da si zapeo između poglavlja – karijera ti više ne daje ono što je nekad davala, a novo poglavlje još nije počelo.</p><br>
                <p>🧠 Osećaš da ti glava radi sto na sat, ali srce nekad ne zna kuda ide.</p><br>
                <p>❤️ Želiš dublje odnose — ne "veze", nego stvarnu prisnost, onu koja ne beži kad postane stvarno.</p><br>
                <p>🔥 Imaš snove, ali ti treba struktura da ih pretvoriš u stvarnost.</p><br>
                <p>🙏 Tražiš balans između snage i mekoće. Između uspeha i duše.</p><br>
                <h2 class="text-2xl font-bold mt-6 mb-2">Šta možeš da dobiješ ovde?</h2><br>
                <p>🎙 Podcast koji dira gde boli i leči gde treba — priče, razgovori, trenuci iskrenosti.</p><br>
                <p>💬 Newsletter koji ne šalje savete — već pitanja zbog kojih se pitaš drugačije.</p><br>
                <p>🛠 Alate za mentalnu snagu, emocionalnu jasnoću i duhovni kompas.</p><br>
                <p></p>📱 A uskoro — PlayMind aplikaciju koja pomaže sportistima (i onima koji se tako osećaju) da pronađu novu pobedu posle karijere.</p><br>
                <h2 class="text-2xl font-bold mt-6 mb-2">U šta verujem?</h2><br>
                <ul class="list-disc pl-6">
                    <li>Biti svoj &gt; biti savršen</li>
                    <li>Zajednica &gt; solo put</li>
                    <li>Prisnost &gt; prelaženje preko stvari</li>
                    <li>Duh iznutra &gt; slika spolja</li>
                    <li>Rad na sebi &gt; rad za priznanje</li>
                </ul>
                <h2 class="text-2xl font-bold mt-6 mb-2">Ako ti je dosta površnosti.</h2>
                <p>Ako znaš da nisi ovde da odigraš tuđu igru.</p><br>
                <h2 class="text-2xl font-bold mt-6 mb-2">📩 Piši mi. 📱 Prijavi se. 🎧 Pusti podcast.</h2><br>
                <h2 class="text-2xl font-bold mt-6 mb-2">Neću ti prodavati snove. Samo ću ti pomoći da čuješ svoje.</h2>
                <h2 class="text-2xl font-bold mt-6 mb-2">--</h2>
                dr Milorad Paunović
            </div>
        </div>

        <!-- Footer -->
        <footer class="w-full py-6 px-6 flex flex-col md:flex-row justify-between items-center bg-gray-900 bg-opacity-70 text-sm border-t border-gray-700">
            <p class="mb-4 md:mb-0">&copy; <span id="current-year"></span> Copywrite by Manojlovic Drazen. All rights reserved.</p>
            <div class="flex flex-col md:flex-row items-center space-y-2 md:space-y-0 md:space-x-6">
                <a href="mailto:drmisko@gmail.com" class="flex items-center gap-2 hover:underline">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
                    <span>drmisko@gmail.com</span>
                </a>

            </div>
        </footer>
    </div>

    <!-- Newsletter Modal -->
    <div id="newsletter-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white text-gray-900 rounded-lg shadow-xl max-w-md w-full p-6 relative">
            <!-- Close button -->
            <button id="close-modal" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            
            <!-- Modal content -->
            <div class="text-center">
                <h3 class="text-xl font-bold mb-4">Prijavi se na Newsletter</h3>
                <p class="text-gray-600 mb-6">Dobijaj najnovije vesti, savete i inspiraciju direktno u svoj inbox.</p>
                
                <form id="newsletter-form" class="space-y-4">
                    <div>
                        <input 
                            type="email" 
                            id="newsletter-email" 
                            placeholder="Unesite svoju email adresu" 
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            required
                        >
                    </div>
                    <button 
                        type="submit" 
                        class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors"
                    >
                        Prijavi se
                    </button>
                </form>
                
                <p class="text-xs text-gray-500 mt-4">
                    Možete se odjaviti u bilo kom trenutku. Poštujemo vašu privatnost.
                </p>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="admin-login-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white text-gray-900 rounded-lg shadow-xl max-w-md w-full p-6 relative">
            <!-- Close button -->
            <button id="close-admin-modal" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            
            <!-- Modal content -->
            <div class="text-center">
                <h3 class="text-xl font-bold mb-4">Admin Login</h3>
                <p class="text-gray-600 mb-6">Unesite svoje admin podatke</p>
                
                <form id="admin-login-form" class="space-y-4">
                    <div>
                        <label for="admin-email" class="block text-sm font-medium text-gray-700 mb-2">
                            Email
                        </label>
                        <input 
                            type="email" 
                            id="admin-email" 
                            required
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="admin@drmpaunovic.rs"
                        >
                    </div>
                    <div>
                        <label for="admin-password" class="block text-sm font-medium text-gray-700 mb-2">
                            Lozinka
                        </label>
                        <input 
                            type="password" 
                            id="admin-password" 
                            required
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Unesite lozinku"
                        >
                    </div>
                    <button 
                        type="submit" 
                        class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors"
                    >
                        Uloguj se
                    </button>
                </form>
                
                <p class="text-xs text-gray-500 mt-4">
                    Samo autorizovani korisnici mogu pristupiti admin panelu.
                </p>
            </div>
        </div>
    </div>

    <!-- Contact Modal -->
    <div id="contact-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white text-gray-900 rounded-lg shadow-xl max-w-md w-full p-6 relative">
            <!-- Close button -->
            <button id="close-contact-modal" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            
            <!-- Modal content -->
            <div class="text-center">
                <h3 class="text-xl font-bold mb-4">Contact me</h3>
                <p class="text-gray-600 mb-6">Pošaljite mi poruku i odgovoriću vam u najkraćem mogućem roku.</p>
                
                <form id="contact-form" class="space-y-4">
                    <div>
                        <label for="contact-email" class="block text-sm font-medium text-gray-700 mb-2">
                            Email adresa
                        </label>
                        <input 
                            type="email" 
                            id="contact-email" 
                            required
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="vas@email.com"
                        >
                    </div>
                    
                    <div>
                        <label for="contact-message" class="block text-sm font-medium text-gray-700 mb-2">
                            Poruka
                        </label>
                        <textarea 
                            id="contact-message" 
                            rows="4"
                            required
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Napišite vašu poruku ovde..."
                        ></textarea>
                    </div>
                    
                    <button 
                        type="submit" 
                        class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors"
                    >
                        Pošalji poruku
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Wait for DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing...');
            
            // Initialize Supabase client
            const supabaseUrl = 'https://prousexeqfrpzejshxpq.supabase.co';
            const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InByb3VzZXhlcWZycHplanNoeHBxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM3ODAzOTAsImV4cCI6MjA2OTM1NjM5MH0.7VYr3xdH3jQaWN2xpBuzqwp3hctHAyS1rIMDOBuTEz8';
            const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

            // Dynamically set the current year in the footer
            document.getElementById('current-year').textContent = new Date().getFullYear();
        
        // Newsletter modal functionality
        const modal = document.getElementById('newsletter-modal');
        const openBtn = document.getElementById('newsletter-btn');
        const closeBtn = document.getElementById('close-modal');
        const form = document.getElementById('newsletter-form');
        const emailInput = document.getElementById('newsletter-email');
        
        // Admin modal functionality
        const adminModal = document.getElementById('admin-login-modal');
        const adminBtn = document.getElementById('admin-btn');
        const closeAdminBtn = document.getElementById('close-admin-modal');
        const adminForm = document.getElementById('admin-login-form');
        const adminEmailInput = document.getElementById('admin-email');
        const adminPasswordInput = document.getElementById('admin-password');
        
        // Check if elements exist
        console.log('Elements found:', {
            modal: !!modal,
            openBtn: !!openBtn,
            closeBtn: !!closeBtn,
            form: !!form,
            emailInput: !!emailInput,
            adminModal: !!adminModal,
            adminBtn: !!adminBtn,
            closeAdminBtn: !!closeAdminBtn,
            adminForm: !!adminForm,
            adminEmailInput: !!adminEmailInput,
            adminPasswordInput: !!adminPasswordInput
        });
        
        // Open newsletter modal
        if (openBtn) {
            openBtn.addEventListener('click', () => {
                if (modal) {
                    modal.classList.remove('hidden');
                    modal.classList.add('flex');
                }
            });
        }
        
        // Close newsletter modal
        if (closeBtn) {
            closeBtn.addEventListener('click', () => {
                if (modal) {
                    modal.classList.add('hidden');
                    modal.classList.remove('flex');
                }
            });
        }
        
        // Open admin modal
        if (adminBtn) {
            adminBtn.addEventListener('click', () => {
                if (adminModal) {
                    adminModal.classList.remove('hidden');
                    adminModal.classList.add('flex');
                }
            });
        }
        
        // Close admin modal
        if (closeAdminBtn) {
            closeAdminBtn.addEventListener('click', () => {
                if (adminModal) {
                    adminModal.classList.add('hidden');
                    adminModal.classList.remove('flex');
                }
            });
        }
        
        // Close modals when clicking outside
        if (modal) {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.add('hidden');
                    modal.classList.remove('flex');
                }
            });
        }
        
        if (adminModal) {
            adminModal.addEventListener('click', (e) => {
                if (e.target === adminModal) {
                    adminModal.classList.add('hidden');
                    adminModal.classList.remove('flex');
                }
            });
        }
        
        // Admin login form submission
        adminForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = adminEmailInput.value.trim();
            const password = adminPasswordInput.value;
            
            console.log('Login attempt:', { email, password });
            
            if (!email || !password) {
                alert('Molimo popunite sva polja.');
                return;
            }
            
            try {
                // Check admin credentials in Supabase
                const { data, error } = await supabase
                    .from('admin_users')
                    .select('*')
                    .eq('email', email)
                    .single();
                
                console.log('Supabase response:', { data, error });
                
                if (error || !data) {
                    console.log('No user found or error:', error);
                    alert('Pogrešan email ili lozinka.');
                    return;
                }
                
                console.log('Found user data:', data);
                console.log('Comparing passwords:', { 
                    input: password, 
                    stored: data.password_hash,
                    match: data.password_hash === password 
                });
                
                // Simple password check (in production, use proper hashing)
                if (data.password_hash === password) {
                    console.log('Password match! Logging in...');
                    // Store admin session
                    localStorage.setItem('adminAuthenticated', 'true');
                    localStorage.setItem('adminEmail', email);
                    
                    // Redirect to admin panel
                    window.location.href = 'admin.html';
                } else {
                    console.log('Password mismatch');
                    alert('Pogrešan email ili lozinka.');
                }
            } catch (error) {
                console.error('Login error:', error);
                alert('Greška pri prijavi. Molimo pokušajte ponovo.');
            }
        });
        
        // Handle form submission
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = emailInput.value.trim();
            
            // Show loading state
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Slanje...';
            submitBtn.disabled = true;
            
            try {
                // Insert email into Supabase
                const { data, error } = await supabase
                    .from('newsletter_subscribers')
                    .insert([
                        { 
                            email: email,
                            status: 'active'
                        }
                    ]);
                
                if (error) {
                    if (error.code === '23505') {
                        // Duplicate email
                        alert('Ova email adresa je već prijavljena na newsletter.');
                    } else {
                        console.error('Error:', error);
                        alert('Greška pri prijavi. Molimo pokušajte ponovo.');
                    }
                } else {
                    // Success
                    alert('Hvala! Uspešno ste se prijavili na newsletter.');
                    
                    // Close modal
                    modal.classList.add('hidden');
                    modal.classList.remove('flex');
                    
                    // Reset form
                    form.reset();
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Greška pri prijavi. Molimo pokušajte ponovo.');
            } finally {
                // Reset button state
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });

        // Contact modal functionality
        const contactModal = document.getElementById('contact-modal');
        const contactBtn = document.getElementById('contact-btn');
        const closeContactBtn = document.getElementById('close-contact-modal');
        const contactForm = document.getElementById('contact-form');
        const contactEmailInput = document.getElementById('contact-email');
        const contactMessageInput = document.getElementById('contact-message');
        
        console.log('Contact elements found:', {
            contactModal: !!contactModal,
            contactBtn: !!contactBtn,
            closeContactBtn: !!closeContactBtn,
            contactForm: !!contactForm
        });
        
        // Open contact modal
        contactBtn.addEventListener('click', () => {
            console.log('Contact button clicked!');
            contactModal.classList.remove('hidden');
            contactModal.classList.add('flex');
        });
        
        // Close contact modal
        closeContactBtn.addEventListener('click', () => {
            contactModal.classList.add('hidden');
            contactModal.classList.remove('flex');
        });
        
        // Close contact modal when clicking outside
        contactModal.addEventListener('click', (e) => {
            if (e.target === contactModal) {
                contactModal.classList.add('hidden');
                contactModal.classList.remove('flex');
            }
        });
        
        // Contact form submission
        contactForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = contactEmailInput.value.trim();
            const message = contactMessageInput.value.trim();
            
            if (!email || !message) {
                alert('Molimo popunite sva polja.');
                return;
            }
            
            try {
                // Send contact form data to your email using the same Edge Function
                const contactData = {
                    subject: 'Nova poruka sa sajta',
                    content: `
                        <h2>Nova poruka sa sajta</h2>
                        <p><strong>Email:</strong> ${email}</p>
                        <p><strong>Poruka:</strong></p>
                        <p>${message.replace(/\n/g, '<br>')}</p>
                    `,
                    recipients: ['drmisko@gmail.com'],
                    isTest: false
                };

                const response = await fetch('https://prousexeqfrpzejshxpq.supabase.co/functions/v1/send-newsletter', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${supabaseKey}`
                    },
                    body: JSON.stringify(contactData)
                });

                if (response.ok) {
                    alert('Hvala! Vaša poruka je uspešno poslata. Odgovoriću vam u najkraćem mogućem roku.');
                    contactForm.reset();
                    contactModal.classList.add('hidden');
                    contactModal.classList.remove('flex');
                } else {
                    alert('Greška pri slanju poruke. Molimo pokušajte ponovo.');
                }
            } catch (error) {
                console.error('Contact form error:', error);
                alert('Greška pri slanju poruke. Molimo pokušajte ponovo.');
            }
        });
        });
    </script>
</body>
</html>